language: node_js
node_js:
  - node
cache:
  directories:
    - node_modules


 


# script: npm run test:$TEST_SUITE

# jobs:
#   include:
#     - stage: deploy
#       env: TEST_SUITE=none
#       install: skip # bundle install is not required
#       script: ./deploy.sh

# safelist
branches:
  only:
  - develop
  # - master

# stages:
#   - name: lint & test
#     if: type = pull_request
#   - name: deploy to aws develop
#     if: type != pull_request
#   - name: e2e tests in develop
#     if: type != pull_request

env:
  - TEST_SUITE=unit
  - TEST_SUITE=integration
  - TEST_SUITE=acceptance

jobs:
  include:
    - stage: lint
      script: echo performing code analysis
    - stage: test
      script: npm run test:$TEST_SUITE
      # if: type = pull_request
    - stage: deploy to aws develop
      script: echo deploying to aws develop
    - stage: e2e tests in develop
      script: echo running live suitable e2e tests in aws develop
    # - stage: deploy to production
    #   if: branch = master AND type != pull_request
    #   script: echo deploying to aws production
    # - stage: e2e tests in production
    #   if: branch = master AND type != pull_request
    #   script: echo running live suitable e2e tests

# notifications:
#   slack: '<account>:<token>#team-backend'
#     on_success: change
#     on_failure: change
#     on_pull_requests: false